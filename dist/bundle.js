(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function e(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{const n=function(t){fetch(`https://geolocation-db.com/json/${t}`).then((function(e){200===e.status?e.json().then((function(e){console.log(e.city)})):alert("err")}));let n="moscow",o="";function r(){let e=[],t="",r="";fetch(`https://api.openweathermap.org/data/2.5/weather?q=${n}&units=metric,{state%20code}&appid=7a272ee75ecd163ddfed4a4a57d3e611&lang=ru`).then((function(n){200===n.status?n.json().then((function(n){e=n,t=e.coord.lon.toString().slice(0,5),r=e.coord.lat.toString().slice(0,5),o=e.weather[0].description,function(e){document.getElementById("current").className="пасмурно"===e?"current bckDark":"current bckCloudy"}(o),function(e){document.querySelector(".current__city").textContent=e.name,document.querySelector(".current__day").textContent=a(e.dt)+" "+(t=e.dt,["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][new Date(1e3*t).getMonth()]+" ")+c(e.dt)+":00",document.querySelector(".current__temp").textContent=Math.round(e.main.temp-273.15),document.querySelector(".current__mainInfo").textContent=e.weather[0].description+", ощущается: "+Math.round(e.main.feels_like-273.15)+", скорость ветра: "+e.wind.speed+" м/с";var t;const n=document.createElement("div");n.innerHTML=`\n  <img class="current__icon" src=http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png>\n  `,document.querySelector(".current__icon").replaceWith(n),console.log(n)}(e),fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${Number(r)}&lon=${Number(t)}&exclude=hourly&appid=7a272ee75ecd163ddfed4a4a57d3e611&lang=ru`).then((function(e){e.json().then((function(e){let t=[];for(let n=0;n<8;n++){let o={day:a(e.daily[n].dt),icon:`https://openweathermap.org/img/wn/${e.daily[n].weather[0].icon}@2x.png`,temp:e.daily[n].temp.day};t.push(o)}!function(e){let t=document.querySelector(".daily");for(;t.firstChild;)t.removeChild(t.firstChild);for(let t=0;t<e.length;t++)new i(e[t].day,e[t].temp,e[t].icon,".daily","item").render()}(t)}))})),fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${Number(r)}&lon=${Number(t)}&exclude=daily&appid=7a272ee75ecd163ddfed4a4a57d3e611&lang=ru`).then((function(e){e.json().then((function(e){let t=[];for(let n=0;n<12;n++){let o={day:c(e.hourly[n].dt),icon:`https://openweathermap.org/img/wn/${e.hourly[n].weather[0].icon}@2x.png`,temp:e.hourly[n].temp};t.push(o)}!function(e){let t=document.querySelector(".hourly");for(;t.firstChild;)t.removeChild(t.firstChild);for(let t=0;t<e.length;t++)new i(e[t].day,e[t].temp,e[t].icon,".hourly","item").render()}(t)}))})).catch((function(e){console.log("Fetch Error :-S",e)}))})):alert("err")}))}function c(e){return new Date(1e3*e).getHours()}function a(e){return new Date(1e3*e).getDate()}document.querySelector(".location").onclick=function(){e()},document.querySelector(".changeCityBtn").onclick=function(){!function(){let e=document.querySelector(".cityInput").value;n=e,r()}()},r();class i{constructor(e,t,n,o,...r){this.day=e,this.temp=Math.round(t-273.15),this.icon=n,this.classes=r,this.parent=document.querySelector(o)}render(){const e=document.createElement("div");this.classes.forEach((t=>e.classList.add(t))),e.innerHTML=`\n        <div  class="day">${this.day}</div>\n        <img class="icon" src=${this.icon}>\n        <div class="temp">${this.temp}</div>\n        `,this.parent.append(e)}}}(t.coords.latitude+"."+t.coords.longitude);getApiData(n)}),(e=>{console.error(e)}))})),ghpages.publish("dist",callback)})();